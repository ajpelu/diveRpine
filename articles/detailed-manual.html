<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="diveRpine">
<title>How diveRpine runs?. Detailed manual • diveRpine</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How diveRpine runs?. Detailed manual">
<meta property="og:description" content="diveRpine">
<meta property="og:image" content="https://ajpelu.github.io/diveRpine/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">diveRpine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ajpelu/diveRpine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How diveRpine runs?. Detailed manual</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ajpelu/diveRpine/blob/HEAD/vignettes/detailed-manual.Rmd" class="external-link"><code>vignettes/detailed-manual.Rmd</code></a></small>
      <div class="d-none name"><code>detailed-manual.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is a detailed description of the functioning of the app and of the <code>diveRpine</code> package. We add some notes to modify and customize the app. This’s a live document.</p>
</div>
<div class="section level2">
<h2 id="landscape-configuration">Landscape configuration<a class="anchor" aria-label="anchor" href="#landscape-configuration"></a>
</h2>
<p>The first step is creating a <strong>virtual</strong> landscape with different land-uses. By default <code>diveRpine</code> uses four different land-uses: pine plantation, natural forest, cropland and others. To create the virtual landscape, <code>diveRpine</code> uses the auxiliary function <code><a href="../reference/create_landscape.html">create_landscape()</a></code>. It generates a raster of 13356 ncell (106 rows and 126 cols) (Figure <a href="#fig:empty">1</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ajpelu.github.io/diveRpine">diveRpine</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dariomasante/landscapeR" class="external-link">landscapeR</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">empty_landscape</span> <span class="op">&lt;-</span> <span class="fu">diveRpine</span><span class="fu">::</span><span class="fu"><a href="../reference/create_landscape.html">create_landscape</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">empty_landscape</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"#FFFFe5"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:empty"></span>
<img src="detailed-manual_files/figure-html/empty-1.png" alt="Empty virtual landscape."><p class="caption">
Figure 1: Empty virtual landscape.
</p>
</div>
<div class="section level4">
<h4 id="target-pine-plantation">Target pine-plantation<a class="anchor" aria-label="anchor" href="#target-pine-plantation"></a>
</h4>
<p>The next step is to configure the target pine-plantation. The user has to specify several features of the target pine-plantation:</p>
<ul>
<li>Pine plantation size (<code>pp_size</code>)</li>
<li>Pine plantation tree density (<code>pp_den</code>): <em>low</em>, <em>medium</em> or <em>high</em>.<br>
</li>
<li>Past land use (<code>pp_use</code>): <em>oak forests</em>, <em>shrublands</em>, <em>pasture</em> or <em>croplands</em>
</li>
<li>Climate-proxy Factors: Elevation (<code>elev</code>) and Annual radiation (<code>rad</code>)</li>
</ul>
<p>For instance, a user could select a pine plantation size of 1000 ha (<code>pp_size</code>) with a low tree density (&lt; 500 tree/ha). The land use previous to the establishment of the pine plantation was <em>Natural Forest</em> (<em>oak</em>). The target pine plantation is located at 1400 <em>m.a.s.l.</em> and with an annual radiation of 4.5 GJm<sup>-2</sup>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here there are some inputs needed for manual rendering (#not run)</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select pine size</span></span>
<span><span class="va">pp_size</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">pp_den</span> <span class="op">&lt;-</span> <span class="st">"low"</span> </span>
<span><span class="va">pp_den_den</span> <span class="op">&lt;-</span> <span class="fl">100</span> </span>
<span><span class="va">pp_use</span> <span class="op">&lt;-</span> <span class="st">"Oak"</span></span>
<span><span class="va">elev</span> <span class="op">&lt;-</span> <span class="fl">1400</span></span>
<span><span class="va">rad</span> <span class="op">&lt;-</span> <span class="fl">4.5</span></span>
<span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">pp_size</span> <span class="op">&lt;-</span> <span class="va">pp_size</span></span></code></pre></div>
<p>The app creates a <strong>pine plantation</strong> patch, with the features selected by the users (Figure <a href="#fig:pine">2</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># position</span></span>
<span><span class="va">position_pine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">empty_landscape</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">empty_landscape</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Create pine plantation target</span></span>
<span><span class="va">pine</span> <span class="op">&lt;-</span> <span class="fu">landscapeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/landscapeR/man/makePatch.html" class="external-link">makePatch</a></span><span class="op">(</span><span class="va">empty_landscape</span>,</span>
<span>  val <span class="op">=</span> <span class="fl">1</span>, rast <span class="op">=</span> <span class="cn">TRUE</span>, bgr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  size <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">pp_size</span>,</span>
<span>  spt <span class="op">=</span> <span class="va">position_pine</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pine</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FFFFe5"</span>, <span class="st">"#a1d99b"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pine"></span>
<img src="detailed-manual_files/figure-html/pine-1.png" alt="Pine plantation created by the user."><p class="caption">
Figure 2: Pine plantation created by the user.
</p>
</div>
</div>
<div class="section level4">
<h4 id="natural-forests">Natural forests<a class="anchor" aria-label="anchor" href="#natural-forests"></a>
</h4>
<p>Then, several <strong>natural forests</strong> patches are created according to user selection. Before, the position of the natural forests are established using the free background space. The position(s) depends on the number of natural forest patch selected by the users. For instance, a user could select 5 natural forest patches (<code>nf_n</code>) with a size range between 100-200 ha (<code>nf_size</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### Get the positions for the creation of the NF patches.</span></span>
<span><span class="va">nf_n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">nf_n</span> <span class="op">&lt;-</span> <span class="va">nf_n</span></span>
<span></span>
<span><span class="co">#### Get the positions for the creation of the NF patches.</span></span>
<span><span class="va">positions_nf</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pine</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, <span class="va">nf_n</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#### Generate the sizes of the natural forests patch</span></span>
<span><span class="va">nf_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">nf_size</span> <span class="op">&lt;-</span> <span class="va">nf_size</span></span></code></pre></div>
<p>Then, the user select the range sizes of the natural forests patches.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nf_sizes</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span></span>
<span>      <span class="va">nf_n</span>,</span>
<span>      <span class="va">input</span><span class="op">$</span><span class="va">nf_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="va">input</span><span class="op">$</span><span class="va">nf_size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Natural forest patches are added to the virtual landscape (Figure <a href="#fig:pineOak">3</a>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##   pine_oak</span></span>
<span><span class="va">pine_oak</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/landscapeR/man/makeClass.html" class="external-link">makeClass</a></span><span class="op">(</span><span class="va">pine</span>,</span>
<span>  val <span class="op">=</span> <span class="fl">2</span>, rast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  npatch <span class="op">=</span> <span class="va">nf_n</span>,</span>
<span>  pts <span class="op">=</span> <span class="va">positions_nf</span>,</span>
<span>  size <span class="op">=</span> <span class="va">nf_sizes</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pine_oak</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FFFFe5"</span>, <span class="st">"#a1d99b"</span>, <span class="st">"green"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pineOak"></span>
<img src="detailed-manual_files/figure-html/pineOak-1.png" alt="Pine plantation (ligth green) and natural forests (green) patches created by the user."><p class="caption">
Figure 3: Pine plantation (ligth green) and natural forests (green) patches created by the user.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crops_size</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="fl">10</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pine_oak</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.05</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="va">n_crops</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">landscape</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/landscapeR/man/makeClass.html" class="external-link">makeClass</a></span><span class="op">(</span><span class="va">pine_oak</span>,</span>
<span>    val <span class="op">=</span> <span class="fl">3</span>, rast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    npatch <span class="op">=</span> <span class="va">n_crops</span>,</span>
<span>    size <span class="op">=</span> <span class="va">crops_size</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">landscape</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">FALSE</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FFFFe5"</span>, <span class="st">"#a1d99b"</span>, <span class="st">"green"</span>, <span class="st">"lightgoldenrod1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:landscapeConfigured"></span>
<img src="detailed-manual_files/figure-html/landscapeConfigured-1.png" alt="Landscape configuration."><p class="caption">
Figure 4: Landscape configuration.
</p>
</div>
</div>
<div class="section level4">
<h4 id="crops">Crops<a class="anchor" aria-label="anchor" href="#crops"></a>
</h4>
<p>Now, <strong>crop</strong> patches are added to the virtual landscape resulting with the first configuration of the landscape (Figure <a href="#fig:landscapeConfigured">4</a>).</p>
</div>
</div>
<div class="section level2">
<h2 id="compute-initial-richness">Compute initial richness<a class="anchor" aria-label="anchor" href="#compute-initial-richness"></a>
</h2>
<p>A richness value is assigned to each pixel. This value will depend on the pixel category (<em>i.e.</em> natural forest, pine plantation, etc).</p>
<div class="section level3">
<h3 id="pine-plantation">Pine plantation<a class="anchor" aria-label="anchor" href="#pine-plantation"></a>
</h3>
<p>For each pixel <span class="math inline">\(j\)</span>, the initial richness value (<span class="math inline">\(R_{init,j}\)</span>) is computed following</p>
<p><span class="math display">\[ Richess \sim Potential\ Richenss \times fc \]</span></p>
<p>where <span class="math inline">\(Potential\ Richenss\)</span> is a random value coming from a range of values obtained from references in our study area <span class="citation">(Gómez-Aparicio et al. 2009, Pérez-Luque et al. 2014)</span>; and <span class="math inline">\(fc\)</span> is a correction factor which considers:</p>
<p><span class="math display">\[fc = w_{past}\cdot f(\mathrm{past~Land~Use}) + w_{dist}\cdot f(\mathrm{Seed~source~distance}) + w_{treeden}\cdot f(\mathrm{Tree~density}) + w_{clim}\cdot f(\mathrm{Climate~proxy})\]</span> We specified the following weights according to literature <span class="citation">(Gómez-Aparicio et al. 2009, Navarro-González et al. 2013, Pérez-Luque et al. 2014)</span>:</p>
<ul>
<li><span class="math inline">\(w_{past} = 0.2\)</span></li>
<li><span class="math inline">\(w_{dist} = 0.35\)</span></li>
<li><span class="math inline">\(w_{treeden} = 0.25\)</span></li>
<li><span class="math inline">\(w_{clim} = 0.2\)</span></li>
</ul>
<div class="section level4">
<h4 id="tree-density-ftreeden">Tree Density (<code>ftreeden</code>)<a class="anchor" aria-label="anchor" href="#tree-density-ftreeden"></a>
</h4>
<p>Richness and species diversity within pine plantation are strongly conditioned by the tree density <span class="citation">(Gómez-Aparicio et al. 2009)</span>. Tree Density of the pine plantation has a negative effect on the plant diversity, and on the total plant species richness. An increase on the plantation tree density provokes decreasing of the richness plant values <span class="citation">(Gómez-Aparicio et al. 2009)</span>. In our study area, the lower diversity of plant species observed in pine plantations is probably due to the high tree density of pine plantations compared to natural forests, which implies lower light levels under the canopy, and this implies lower diversity of herbaceous species.</p>
<p>In addition, the abundance and richness of disperses birds is negatively affected at high tree densities (especially for jays), reducing the flow of seeds entering into the pine plantations, and thus the potential plant species diversity within them.</p>
<p>So, potential richness is affected by pine forest density. Thus, according to Eq. 3 of <span class="citation">Gómez-Aparicio et al. (2009)</span>, potential richness is affected as a function of density, as follows:</p>
<p><span class="math display">\[ ftreeden = \exp \left [ -\frac{1}{2} \left( \frac{ treeDensity - 0.22} {1504.1} \right )^2\right ] \]</span></p>
</div>
<div class="section level4">
<h4 id="seed-source-distance-fdist">Seed source distance (<code>fdist</code>)<a class="anchor" aria-label="anchor" href="#seed-source-distance-fdist"></a>
</h4>
<p>Seed dispersal depends on the distance from the seed source <span class="citation">(Hewitt and Kellman 2002)</span>. In pine plantations, the presence and abundance of species other than pines is determined, among others, by the distance to the seed source <span class="citation">(González-Moreno et al. 2011)</span>, although it is not the only reason that explains the diversity observed in pine plantations.</p>
<p><span class="citation">González-Moreno et al. (2011)</span> found that, of the different vegetation types considered in our study are, natural oak forests are the most influential in terms of distance to the seed source. Oak vegetation has higher plant diversity than pine plantations,especially for herbaceous species <span class="citation">(Gómez-Aparicio et al. 2009)</span>. Shorter distances could increase the pool of species in the pine plantations and reduce the evenness of plantation communities.</p>
<p>Specifically, the relationship found between distance to the source and diversity observed in pine plantations is governed by the following equation:</p>
<p><span class="math display">\[ Diversity = 1.7605 - 0.0932 * \sqrt{\sqrt{Distance}}\]</span></p>
<p>So, for each pixel of pine plantation the distances between the centroid of the pixel and the edge of each natural forest patches are computed using the function <code><a href="../reference/dist2nf.html">dist2nf()</a></code> (Figure <a href="#fig:distance-raster">5</a>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dist2nf.html">dist2nf</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span></span>
<span></span>
<span><span class="va">borde_pine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterToPolygons.html" class="external-link">rasterToPolygons</a></span><span class="op">(</span><span class="va">landscape</span>,</span>
<span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">==</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span>, dissolve <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">nf_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterToPolygons.html" class="external-link">rasterToPolygons</a></span><span class="op">(</span><span class="va">landscape</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">==</span> <span class="va">nf_value</span></span>
<span><span class="op">}</span>, dissolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist_raster</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">magma</a></span><span class="op">(</span><span class="fl">25</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">borde_pine</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nf_edges</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distance-raster"></span>
<img src="detailed-manual_files/figure-html/distance-raster-1.png" alt="Distance of natural forests's pixels to pine plantation's pixels."><p class="caption">
Figure 5: Distance of natural forests’s pixels to pine plantation’s pixels.
</p>
</div>
<p>Then, we compute the distance effect on the diversity for all the landscape (Figure <a href="#fig:distance-effect">6</a>), but we will focus only on pine plantations (Figure <a href="#fig:distance-effectpine">7</a>). We can see that pixels close to natural forest patches has higher values of diversity.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Compute diversity raster (See Gonzalez-Moreno et al. 2011)</span></span>
<span><span class="va">sh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">dist_raster</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">1.7605</span> <span class="op">-</span> <span class="fl">0.0932</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sh</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distance-effect"></span>
<img src="detailed-manual_files/figure-html/distance-effect-1.png" alt="Distance effect on diversity according to Gonzalez-Moreno et al. (2011)."><p class="caption">
Figure 6: Distance effect on diversity according to Gonzalez-Moreno et al. (2011).
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">landscape1</span> <span class="op">&lt;-</span> <span class="va">landscape</span></span>
<span><span class="va">landscape1</span><span class="op">[</span><span class="va">landscape1</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">landscape1</span>, <span class="va">sh</span><span class="op">)</span>, </span>
<span>          fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="fl">100</span>, <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">borde_pine</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distance-effectpine"></span>
<img src="detailed-manual_files/figure-html/distance-effectpine-1.png" alt="Distance effect on diversity for pine plantation according to Gonzalez-Moreno et al. (2011)."><p class="caption">
Figure 7: Distance effect on diversity for pine plantation according to Gonzalez-Moreno et al. (2011).
</p>
</div>
<p>We scaled the distance effect from 0 to 1 (Figure <a href="#fig:distance-effectpinescaled">8</a>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Scale the distance effect from 0 to 1</span></span>
<span><span class="va">sh_scaled</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">s</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/cellStats.html" class="external-link">cellStats</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/cellStats.html" class="external-link">cellStats</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"max"</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/cellStats.html" class="external-link">cellStats</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sh_scaled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">borde_pine</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distance-effectpinescaled"></span>
<img src="detailed-manual_files/figure-html/distance-effectpinescaled-1.png" alt="Distance effect (scaled values) on diversity for pine plantation according to Gonzalez-Moreno et al. (2011)."><p class="caption">
Figure 8: Distance effect (scaled values) on diversity for pine plantation according to Gonzalez-Moreno et al. (2011).
</p>
</div>
</div>
<div class="section level4">
<h4 id="past-land-use">Past Land Use<a class="anchor" aria-label="anchor" href="#past-land-use"></a>
</h4>
<p>The past land-use affects to seed banks. In our study area, seedling regeneratio of <em>Quercus</em> species within pine plantation depends on past land-use, distance to seed sources and tree density <span class="citation">(Gómez-Aparicio et al. 2009, Navarro-González et al. 2013)</span>. We know that the regeneration of <em>Quercus</em> in pine plantations depends more on past land-use than on plantation tree density and distance to the seed source (see table 2 in <span class="citation">Navarro-González et al. (2013)</span>). To quantify the importance of each of the three variables, we look at the values of variance explained by each of the models for each variable. Subsequently, we rescale the importance of each variable and obtain:</p>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-6">Table 1: </span>Rescaled importance of varaibles. From Navarro-González et al. (2013)
</caption>
<thead><tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
Pseudo.R2
</th>
<th style="text-align:right;">
rescaled.importance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
past Land Use
</td>
<td style="text-align:right;">
0.1238
</td>
<td style="text-align:right;">
0.4767
</td>
</tr>
<tr>
<td style="text-align:left;">
Propagule source distance
</td>
<td style="text-align:right;">
0.0832
</td>
<td style="text-align:right;">
0.3204
</td>
</tr>
<tr>
<td style="text-align:left;">
Pine tree density
</td>
<td style="text-align:right;">
0.0057
</td>
<td style="text-align:right;">
0.2029
</td>
</tr>
</tbody>
</table>
<p>Therefore, we can say that the regeneration of <em>Quercus</em> under pine plantation followed the next rule:</p>
<p><span class="math display">\[ reg \sim 0.4767 \cdot pastlandUse + 0.3204 \cdot Distance + 0.2029 \cdot Density  \]</span> We consider only the past land-use, as tree-density and distance to source are considered in a above hierarchical level.</p>
<p>But, we need to know the contribution (importance) of the <em>Quercus</em> species to the richness found in pine plantations. We use data from SINFONEVADA Forest inventory <span class="citation">(Pérez-Luque et al. 2014)</span>. Of the total richness observed in the SINFONEVADA plots, we analyze how much is due to the contribution of <em>Quercus</em> species</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"diversity_sinfonevada.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># How many species by plot</span></span>
<span><span class="va">richness_loc</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">decimalLatitude</span>, <span class="va">decimalLongitude</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">'id_plot'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>rich <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get number of quercus species by plot </span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Quercus"</span>, <span class="va">scientificName</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">decimalLatitude</span>, <span class="va">decimalLongitude</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>rich_quercus <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get total richness by plot </span></span>
<span><span class="va">richness_tot</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">decimalLatitude</span>, <span class="va">decimalLongitude</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>rich_total <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="va">per_quercus_plot</span> <span class="op">&lt;-</span> <span class="va">richness_tot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">q</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'decimalLatitude'</span>, <span class="st">'decimalLongitude'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="va">rich_quercus</span> <span class="op">/</span> <span class="va">rich_total</span><span class="op">)</span></span>
<span></span>
<span><span class="va">per_quercus_plot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">per</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'% Quercus species by plot'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:quercusImp"></span>
<img src="detailed-manual_files/figure-html/quercusImp-1.png" alt="Percentage of Quercus species by plot in forest inventories of Sierra Nevada (*n* = 600 plots; Pérez-Luque et al. 2014)."><p class="caption">
Figure 9: Percentage of Quercus species by plot in forest inventories of Sierra Nevada (<em>n</em> = 600 plots; Pérez-Luque et al. 2014).
</p>
</div>
<p><em>Quercus</em> contribute (on average) to the richness of the plot about 9 % (Figure <a href="#fig:quercusImp">9</a>), therefore, we should adjust the contribution of land use to the richness of the pine forest plots.</p>
<p>The richness value of a plantation is conditioned by the past land use <span class="citation">(Navarro-González et al. 2013)</span>, since the probability of finding recruits of <em>Quercus</em> species within a pine plantations depends on the past land use of that plantation. <span class="citation">Navarro-González et al. (2013)</span> differentiate between the probability of finding regeneration in a pine plantation and the amount of regeneration (number of recruits) found within pine plantation. In our case, we are more interested in the probability of finding regeneration, rather than abundance. Thus we have that:</p>
<ul>
<li>The probability of not finding regeneration within a plantation varies as a function of past land use. For each of the past land uses the zero-inflated model of <span class="citation">(Navarro-González et al. 2013)</span> estimates <em>odds-ratio</em>. These values have been rescaled between 0.0001 and 0.9999. We have computed the inverse (1 - x) of the rescaled probability (to convert it into probability of finding regenerated). Thus we have:</li>
</ul>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-10">Table 2: </span>Rescaled probability of finding regeneration. From Navarro-González et al. (2013)
</caption>
<thead><tr>
<th style="text-align:left;">
Past.Land.Use
</th>
<th style="text-align:right;">
odds.Ratio
</th>
<th style="text-align:right;">
rescaleValue
</th>
<th style="text-align:right;">
reverse.Rescale.Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Oak formation
</td>
<td style="text-align:right;">
0.3935
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
0.9999
</td>
</tr>
<tr>
<td style="text-align:left;">
Mid-mountain Shrubland
</td>
<td style="text-align:right;">
1.7576
</td>
<td style="text-align:right;">
0.5018
</td>
<td style="text-align:right;">
0.4982
</td>
</tr>
<tr>
<td style="text-align:left;">
Pasture
</td>
<td style="text-align:right;">
3.1119
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
Cropland
</td>
<td style="text-align:right;">
3.0362
</td>
<td style="text-align:right;">
0.9720
</td>
<td style="text-align:right;">
0.0279
</td>
</tr>
</tbody>
</table>
<p>where, the <strong>rescaled probability of finding regeneration</strong> as a function of land use follows the following gradient: Holm oak forest (0.9999) &gt; Shrubland (0.4982) &gt; Cropland (0.0279) &gt; Grassland (0.0001).</p>
<ul>
<li>The amount of regenerated also depends on past use <span class="citation">(Navarro-González et al. 2013)</span>. In our model, the amount of regeneration does not affect richness, but simply the presence and/or absence of regeneration, so we will use only the rescaled probability of finding regeneration to include past land use.</li>
</ul>
<p>Note that all these values are for the same distance and an average density of 750 pines / ha.</p>
</div>
<div class="section level4">
<h4 id="climate-proxy-variables">Climate-proxy variables<a class="anchor" aria-label="anchor" href="#climate-proxy-variables"></a>
</h4>
<p>Climatic conditions are important determinants of species richness, particularly in mountainous regions. In our study area (Sierra Nevada, southern Spain), <span class="citation">Gómez-Aparicio et al. (2009)</span> found an effect of climate conditions on potential species richness within pine plantations. These authors used 19 variables related to climatic and topographic conditions, and applied a principal components analysis (PCA), and they found that elevation and annual radiation were the variables most correlated with the first two axes of the PCA (which explaining 83.3 % of the variance) (See equation 2 and Figures 5A-B in <span class="citation">Gómez-Aparicio et al. (2009)</span>). They found that climate have a strong effect on plant richness and also on potential regeneration. In our app, diveRpine, we only considered the potential richness, and
the effect of climate conditions on the potential richness within pine plantations were implemented using the equation 2 of <span class="citation">Gómez-Aparicio et al. (2009)</span>, specifically:
<span class="math display">\[\mathrm{Climatic~effect}=\mathrm{exp}\left [-\frac{1}{2}\left ( \frac{\mathrm{Altitude }- \mathrm{XA_0}}{\mathrm{XA_b}} \right )^{2}  \right ] \times ~\mathrm{exp}\left [-\frac{1}{2}\left ( \frac{\mathrm{Radiation }- \mathrm{XR_0}}{\mathrm{XR_b}} \right )^{2}  \right ]\]</span> with <span class="math inline">\(\mathrm{XA_0}=1557.16\)</span>, <span class="math inline">\(\mathrm{XA_b}=644.89\)</span>, <span class="math inline">\(\mathrm{XR_0}=0\)</span>, and <span class="math inline">\(\mathrm{XR_b}=13.24\)</span></p>
<p>This equation in used as default in <code>initRichess()</code> with the argument <code>fclim</code>,
that used the elevation (<code>elev</code>) and radiation (<code>rad</code>) values specified by the
user in the diveRpine app.</p>
</div>
</div>
<div class="section level3">
<h3 id="natural-forests-an-crops">Natural Forests an Crops<a class="anchor" aria-label="anchor" href="#natural-forests-an-crops"></a>
</h3>
<p>For natural forests and crop pixels, the initial richness value will be randomly selected from a specific richness range.</p>
<ul>
<li><p>Pixels belong to Natural forest. Initial richness value of each pixel will randomly selected from a specific richness range. This specific range comes from field inventories carry out in our study area <span class="citation">(Gómez-Aparicio et al. 2009, Pérez-Luque et al. 2014)</span>. Range: 13.72 - 16.11</p></li>
<li><p>Pixels belong to Crops. Initial richness value of each pixel will randomly selected from a specific richness range. This specific range comes references <span class="citation">(Mendoza et al. 2009, Matías et al. 2010)</span><br>
Range: 1 - 2</p></li>
</ul>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-12">Table 3: </span>Richness ranges values
</caption>
<thead><tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Type numeric
</th>
<th style="text-align:right;">
Low Richness value
</th>
<th style="text-align:right;">
High Richness value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Pine plantation
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.82
</td>
<td style="text-align:right;">
13.34
</td>
</tr>
<tr>
<td style="text-align:left;">
Natural Forests
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
13.72
</td>
<td style="text-align:right;">
16.11
</td>
</tr>
<tr>
<td style="text-align:left;">
Crops
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
2.00
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="initial-richness">Initial Richness<a class="anchor" aria-label="anchor" href="#initial-richness"></a>
</h3>
<p>The initial Richness is computed using the function <code><a href="../reference/initRichness.html">initRichness()</a></code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># landscape() </span></span>
<span><span class="co"># dist_raster()</span></span>
<span><span class="co"># ri_range (init params )</span></span>
<span><span class="co"># den_pp()$den </span></span>
<span><span class="co"># pastUse()</span></span>
<span></span>
<span><span class="va">rasterRich</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initRichness.html">initRichness</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">landscape</span>, </span>
<span>                           draster <span class="op">=</span> <span class="va">dist_raster</span>, </span>
<span>                           r_range <span class="op">=</span> <span class="va">r_range</span>,</span>
<span>                           treedensity <span class="op">=</span> <span class="va">pp_den_den</span>, </span>
<span>                           pastUse <span class="op">=</span> <span class="va">pp_use</span>, </span>
<span>                           elev <span class="op">=</span> <span class="fl">1500</span>, </span>
<span>                           rad <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                           rescale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>And it can be plotted using <code><a href="../reference/plot_richness.html">plot_richness()</a></code> (Figure <a href="#fig:initialrichness">10</a>)</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_richness.html">plot_richness</a></span><span class="op">(</span><span class="va">rasterRich</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:initialrichness"></span>
<img src="detailed-manual_files/figure-html/initialrichness-1.png" alt="Initial Richness of the landscape."><p class="caption">
Figure 10: Initial Richness of the landscape.
</p>
</div>
</div>
<div class="section level3">
<h3 id="get-values-of-richness-for-nf-and-pine">Get values of Richness for NF and Pine<a class="anchor" aria-label="anchor" href="#get-values-of-richness-for-nf-and-pine"></a>
</h3>
<p>We used an custom function to compute the mean, min and max. This function (<code><a href="../reference/summaryRaster.html">summaryRaster()</a></code>) takes a raster and compute the mean, max and min values of the cells.</p>
<p>We applied this function to compute the Richness values of Natural forests patches (Figures <a href="#fig:nfrichness">11</a> and <a href="#fig:nfrichnesshist">12</a>), and Pine plantation target patch (Figures <a href="#fig:pinerichness">13</a> and <a href="#fig:pinerichnesshist">14</a>) (init and end configuration). The summary values are displayed on the bottom-left side of the
diveRpine app.</p>
<div class="section level4">
<h4 id="natural-forests-1">Natural Forests<a class="anchor" aria-label="anchor" href="#natural-forests-1"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rich_nf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">landscape</span>, <span class="va">rasterRich</span><span class="op">)</span>, </span>
<span>  fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">nf_value</span>, <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">nf_value</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rich_nf</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:nfrichness"></span>
<img src="detailed-manual_files/figure-html/nfrichness-1.png" alt="Richness for natural forests."><p class="caption">
Figure 11: Richness for natural forests.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfnf</span><span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rich_nf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfnf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"n pixels"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Richness Value"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dfnf</span><span class="op">$</span><span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Natural Forests"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:nfrichnesshist"></span>
<img src="detailed-manual_files/figure-html/nfrichnesshist-1.png" alt="Histogram of richness for natural forests"><p class="caption">
Figure 12: Histogram of richness for natural forests
</p>
</div>
<p>The mean, min and max values for natural forests are showed in the value box of the bottom-left part of the app.</p>
</div>
<div class="section level4">
<h4 id="pine-plantation-1">Pine plantation<a class="anchor" aria-label="anchor" href="#pine-plantation-1"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pp_value</span> <span class="op">&lt;-</span> <span class="fl">1</span> </span>
<span><span class="va">rich_pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">landscape</span>, <span class="va">rasterRich</span><span class="op">)</span>, fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">pp_value</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rich_pp</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pinerichness"></span>
<img src="detailed-manual_files/figure-html/pinerichness-1.png" alt="Initial Richness for pine plantations."><p class="caption">
Figure 13: Initial Richness for pine plantations.
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfpp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rich_pp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dfpp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"n pixels"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Richness Value"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dfpp</span><span class="op">$</span><span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Pine plantation"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pinerichnesshist"></span>
<img src="detailed-manual_files/figure-html/pinerichnesshist-1.png" alt="Histogram of initial richness for pine forests"><p class="caption">
Figure 14: Histogram of initial richness for pine forests
</p>
</div>
<p>The mean, min and max values for the initial pine plantation are showed in the value box of the bottom-left part of the app.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="dispersal-module">Dispersal module<a class="anchor" aria-label="anchor" href="#dispersal-module"></a>
</h2>
<p>The next step is computed the input of seed propagules from sources (<em>natural forest</em>) into target <em>pine plantation</em> via <em>dispersers</em> <span class="citation">(sensu Nathan et al. 2012)</span>.</p>
<p>The quantity and quality of seed dispersion are influenced by:</p>
<ul>
<li>Seed sources: seed diversity in seed source patch, and patch size</li>
<li>Disperser: percentage of each disperser</li>
<li>Landscape configuration</li>
</ul>
<div class="section level3">
<h3 id="dispersers">Dispersers<a class="anchor" aria-label="anchor" href="#dispersers"></a>
</h3>
<p>We have considered three classes of dispersers:</p>
<ul>
<li><p><strong>small birds</strong>, <em>e.g.</em> European robin (<em>Erithacus rubecula</em>); Sardinian warbler (<em>Sylvia melanocephala</em>)</p></li>
<li><p><strong>medium birds</strong>, <em>e.g.</em> Eurasian jay (<em>Garrulus glandarius</em>)</p></li>
<li><p><strong>mammals</strong>, <em>e.g.</em> Red fox (<em>Vulpes vulpes</em>)</p></li>
</ul>
<p>For each type of disperser, different <em>dispersion kernels</em> have been considered:</p>
<ul>
<li><p><em>Small-sized birds</em> rarely exceed 100 m in distance, and approximately 50% of the seeds are dispersed in the first 50 m <span class="citation">(Jordano et al. 2007, Zamora et al. 2010)</span>.</p></li>
<li><p><em>Medium-sized birds</em> disperse 50% of the seeds over a distance of more than 100 m <span class="citation">(Jordano et al. 2007)</span>. The Eurasyan jay shows a dispersion range between 5 and 1000 m for Sierra Nevada mountains (SE Spain)<span class="citation">(Gómez 2003)</span>. The distance at which the maximum dispersion occurs depends on the target patch, being approximately 400 me when the target patch is a pine plantation <span class="citation">(Pons and Pausas 2007)</span>.</p></li>
<li><p><em>Mammals</em> disperse in a range from 0 to more than 1500 m, with the dispersion peak at 650 - 700 m. More than 50% of the seeds dispersed by mammals are deposited at distances greater than 495 m <span class="citation">(Matías et al. 2010)</span>.</p></li>
</ul>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-14">Table 4: </span>Features of the dispersers
</caption>
<thead><tr>
<th style="text-align:left;">
Dispersers
</th>
<th style="text-align:left;">
Dispersion range
(m)
</th>
<th style="text-align:left;">
Peak distance
</th>
<th style="text-align:left;">
50% Distance
</th>
<th style="text-align:left;">
Refs.
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Small birds
</td>
<td style="text-align:left;">
0 - 100
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
&lt; 51
</td>
<td style="text-align:left;">
<span class="citation">Jordano et al. (2007)</span>; <span class="citation">Zamora et al. (2010)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Medium birds
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
&gt; 110
</td>
<td style="text-align:left;">
<span class="citation">Jordano et al. (2007)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Eurasian jay
</td>
<td style="text-align:left;">
5 - 1000
</td>
<td style="text-align:left;">
263*; 402**
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="citation">Gómez (2003)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
3 - 550
</td>
<td style="text-align:left;">
68
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="citation">Pons and Pausas (2007)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Mammals
</td>
<td style="text-align:left;">
0 - 990
</td>
<td style="text-align:left;">
650 - 700
</td>
<td style="text-align:left;">
&gt; 495
</td>
<td style="text-align:left;">
<span class="citation">Jordano et al. (2007)</span>; <span class="citation">Matías et al. (2010)</span>
</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:kernel"></span>
<img src="detailed-manual_files/figure-html/kernel-1.png" alt="Dispersion kernels used for each disperser in diveRpine."><p class="caption">
Figure 15: Dispersion kernels used for each disperser in diveRpine.
</p>
</div>
<p>According to the disperser type, the <code><a href="../reference/potential_dispersion.html">potential_dispersion()</a></code> function uses by
default different dispersion kernels. For small and medium birds a log-normal
dispersion kernels were used. Specifically, log-normal density function with mean
and standard deviation values of <span class="math inline">\(log(51)\)</span> and <span class="math inline">\(log(2)\)</span> respectively for
small-sized birds, and log-normal density function with mean and standard deviation
values of <span class="math inline">\(log(201)\)</span> and <span class="math inline">\(log(2)\)</span> for medium-sized birds. This distribution were
implemented using the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Lognormal.html" class="external-link"><code>stats::dlnorm()</code></a> function. For mammals, a combination of
log-normal and Weibull dispersion kernel was used. Specifically, from 0 to 400 m
of distance from the seed source, a Weibull distribution with a shape and scale
parameters of 1.385 and 137 respectively was used (See <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Weibull.html" class="external-link"><code>stats::dweibull()</code></a>);
whereas a log-normal density function with mean and standard deviation values of
<span class="math inline">\(log(751)\)</span> and <span class="math inline">\(log(1.346)\)</span> respectively, were applied for distances higher than
401 m from seed source. Different kernels functions could be specified using the
parameters <code>kernel_sbi</code>, <code>kernel_mbi</code>, and <code>kernel_ma</code> within <code><a href="../reference/potential_dispersion.html">potential_dispersion()</a></code>
(see Advanced configuration article).</p>
<p>For each of the natural forest patches, the distance to the target pine plantation is computed. For instance, we computed the distance from the natural forest patch located at bottom-left side of our landscape (Figure <a href="#fig:landscapeConfigured">4</a>). And then, we applied the kernels of each disperser type using the seed source values ((Figure <a href="#fig:distanceNF">16</a>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">landscape</span></span>
<span><span class="co"># Get polygons of Natural forests </span></span>
<span><span class="va">nf_edges</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterToPolygons.html" class="external-link">rasterToPolygons</a></span><span class="op">(</span><span class="va">x</span>, fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">==</span> <span class="va">nf_value</span><span class="op">}</span>, dissolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">nf_patches</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/disaggregate.html" class="external-link">disaggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">nf_edges</span><span class="op">)</span>, <span class="st">"Spatial"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="co"># distance between nf polygong i and cells of the raster </span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gDistance.html" class="external-link">gDistance</a></span><span class="op">(</span><span class="va">nf_patches</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, <span class="fu">methods</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"SpatialPoints"</span><span class="op">)</span>, byid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">d_nfi</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span><span class="va">d_nfi</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span> <span class="co"># compute minimun distance; and multiply by 10 meters  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d_nfi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"nf"</span>, <span class="va">i</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d_nfi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nf_patches</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distanceNF"></span>
<img src="detailed-manual_files/figure-html/distanceNF-1.png" alt="Distance from a natural forest patches to all the virtual landscape."><p class="caption">
Figure 16: Distance from a natural forest patches to all the virtual landscape.
</p>
</div>
<p>As we previously stated, we used different functions to compute the kernels of each disperser <code>kernel_sbi</code>, <code>kernel_mbi</code>, and <code>kernel_ma</code>. And the compute the potential contribution of propagules into target pine plantation according to the richness values of the natural forest patches.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the mean, sd, se richness of the nf patch  </span></span>
<span><span class="va">rich_nfi</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">rich_nf</span>, <span class="va">nf_patches</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rich.mean</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/cellStats.html" class="external-link">cellStats</a></span><span class="op">(</span><span class="va">rich_nfi</span>, stat <span class="op">=</span> <span class="st">"mean"</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rich.sd</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/cellStats.html" class="external-link">cellStats</a></span><span class="op">(</span><span class="va">rich_nfi</span>, stat <span class="op">=</span> <span class="st">"sd"</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rich.se</span> <span class="op">&lt;-</span> <span class="va">rich.sd</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rich_nfi</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">rich_nfi</span>, value<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="small-birds-contribution">Small birds contribution<a class="anchor" aria-label="anchor" href="#small-birds-contribution"></a>
</h5>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Small bird </span></span>
<span><span class="va">sbi</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">d_nfi</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span>, sdlog <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sbi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'sb'</span>,<span class="va">i</span><span class="op">)</span></span>
<span><span class="co">### potential contribution </span></span>
<span><span class="va">sbipot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">sbi</span><span class="op">*</span><span class="va">rich.mean</span>, <span class="va">sbi</span><span class="op">*</span><span class="va">rich.sd</span>, <span class="va">sbi</span><span class="op">*</span><span class="va">rich.se</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sbipot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sbpot_"</span>, <span class="va">i</span>, <span class="st">"_mean"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sbpot_"</span>, <span class="va">i</span>, <span class="st">"_sd"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sbpot_"</span>, <span class="va">i</span>, <span class="st">"_se"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sbipot</span><span class="op">$</span><span class="va">sbpot_2_mean</span>, main<span class="op">=</span><span class="st">"Small birds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nf_patches</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:smallbirdplot"></span>
<img src="detailed-manual_files/figure-html/smallbirdplot-1.png" alt="Potential contribution from a natural forest patches by the small birds disperser."><p class="caption">
Figure 17: Potential contribution from a natural forest patches by the small birds disperser.
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Medium bird </span></span>
<span><span class="va">mbi</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">d_nfi</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">201</span><span class="op">)</span>, sdlog <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mbi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'mb'</span>,<span class="va">i</span><span class="op">)</span></span>
<span><span class="co">### potential contribution </span></span>
<span><span class="va">mbipot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">mbi</span><span class="op">*</span><span class="va">rich.mean</span>, <span class="va">mbi</span><span class="op">*</span><span class="va">rich.sd</span>, <span class="va">mbi</span><span class="op">*</span><span class="va">rich.se</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mbipot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mbpot_"</span>, <span class="va">i</span>, <span class="st">"_mean"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mbpot_"</span>, <span class="va">i</span>, <span class="st">"_sd"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mbpot_"</span>, <span class="va">i</span>, <span class="st">"_se"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mbipot</span><span class="op">$</span><span class="va">mbpot_2_mean</span>, main<span class="op">=</span><span class="st">"Medium birds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nf_patches</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="detailed-manual_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Mammals </span></span>
<span><span class="va">mai</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">d_nfi</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">400</span>, </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></span><span class="op">(</span><span class="va">x</span>, shape <span class="op">=</span> <span class="fl">1.385</span>, scale <span class="op">=</span> <span class="fl">137</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="fl">6.621</span>, sdlog <span class="op">=</span> <span class="fl">0.297</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mai</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'ma'</span>,<span class="va">i</span><span class="op">)</span></span>
<span><span class="co">### potential contribution </span></span>
<span><span class="va">maipot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">mai</span><span class="op">*</span><span class="va">rich.mean</span>, <span class="va">mai</span><span class="op">*</span><span class="va">rich.sd</span>, <span class="va">mai</span><span class="op">*</span><span class="va">rich.se</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">maipot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mapot_"</span>, <span class="va">i</span>, <span class="st">"_mean"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mapot_"</span>, <span class="va">i</span>, <span class="st">"_sd"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mapot_"</span>, <span class="va">i</span>, <span class="st">"_se"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maipot</span><span class="op">$</span><span class="va">mapot_2_mean</span>, main<span class="op">=</span><span class="st">"Mammals"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nf_patches</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="detailed-manual_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="adjacency">Adjacency<a class="anchor" aria-label="anchor" href="#adjacency"></a>
</h4>
<p>Then, for each natural forest patches the adjacency to the pine-plantation target is computed. The higher the adjacency between the natural forest and the pine plantation, the lower the limitation of the propagule entry dispersed by birds. <span class="citation">Zamora et al. (2010)</span> found that the intercept and the
slope of the linear relation between the seed limitation (values from 0 to 1) and the adjacency (<em>i.e.</em> percentage of pine-plantation perimeter in contact with native forests) were 0.733 and 0.0039 respectively. Those parameters are
included by default in the function <code><a href="../reference/potential_dispersion.html">potential_dispersion()</a></code>, but could be customized using the <code>seedlim_int</code> and <code>seedlim_slope</code> parameters. For each natural forest patch, the adjacency to target pine-plantation is computed. For those patches with adjacency, the potential dispersion by birds increases according a correction factor, that is computed as follows:</p>
<p><span class="math display">\[adj_{fc} = 1 + \frac{\textrm{seed Entry} - \textrm{seed Entry}_{0}}{\textrm{seed Entry}_{100} - \textrm{seed Entry}_{0}}\]</span></p>
<p>where <span class="math inline">\(\textrm{seed Entry} = 1- \textrm{seed limitation}\)</span>; <span class="math inline">\(\textrm{seed limitation}\)</span> is computed using the <code>seedlim_int</code> and <code>seedlim_slope</code> parameters; <span class="math inline">\(\textrm{seed Entry}_{0}\)</span> and <span class="math inline">\(\textrm{seed Entry}_{100}\)</span> correspond to the seed entry for no adjacency and full adjacency respectively <span class="citation">(Zamora et al. 2010)</span>.</p>
<p>For instance, one of the natural forest patches, intersects to target-pine plantation (Figure <a href="#fig:inter">18</a>). The adjacency between natural forest patch and pine plantation corresponds to 0 % of the pine-plantation perimeter. So for this natural forest patch, a seed-entry is computed following the previous equation, and a factor of correction is applied to the input propagule.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pine</span>, add<span class="op">=</span><span class="cn">TRUE</span>, border<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nf_patches</span><span class="op">[</span><span class="va">patch_adjacente</span>, <span class="op">]</span>, border<span class="op">=</span><span class="st">"brown"</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:inter"></span>
<img src="detailed-manual_files/figure-html/inter-1.png" alt="Example of intersection between pine plantation and a natural forest pacth."><p class="caption">
Figure 18: Example of intersection between pine plantation and a natural forest pacth.
</p>
</div>
<p>According to literature, propagules input by birds and mammals in mountain pine plantation of our study area representing 3.7 and 0.2 seeds m<sup>2</sup> yr<sup>−1</sup> respectively <span class="citation">(Matías et al. 2010, Zamora et al. 2010)</span>. Those values are specified in the server part of the app (see <code>server.R</code>; to modify them see Advanced configuration article).</p>
<p>The user determines the percentage of each disperser type using the slide bars in diveRpine. Those values are used as <em>weigths</em> to ponderate the contribution of
each disperser to the input propagule into pine-plantation.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span><span class="op">$</span><span class="va">sb</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">mb</span> <span class="op">&lt;-</span> <span class="fl">35</span> </span>
<span><span class="va">perma</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">-</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">sb</span> <span class="op">+</span> <span class="va">input</span><span class="op">$</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p>Once, the diserpser types are configurated, the potential input of propagules into the pine plantation is computed using <code><a href="../reference/potential_dispersion.html">potential_dispersion()</a></code> and <code><a href="../reference/input_propagule.html">input_propagule()</a></code>.The output is following at (Figure <a href="#fig:plotpropagule">19</a>).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pot_disp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/potential_dispersion.html">potential_dispersion</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, rich_nf <span class="op">=</span> <span class="va">rich_nf</span>,</span>
<span>                                 nf_value <span class="op">=</span> <span class="fl">2</span>, pp_value <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pot_disp_pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/input_propagule.html">input_propagule</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, pd <span class="op">=</span> <span class="va">pot_disp</span>, pp_value <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">propagule_sb</span> <span class="op">&lt;-</span> <span class="va">pot_disp_pp</span><span class="op">[[</span><span class="st">'sb'</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">sb</span><span class="op">)</span> <span class="op">*</span> <span class="va">piBird</span></span>
<span><span class="va">propagule_mb</span> <span class="op">&lt;-</span> <span class="va">pot_disp_pp</span><span class="op">[[</span><span class="st">'mb'</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">mb</span><span class="op">)</span> <span class="op">*</span> <span class="va">piBird</span></span>
<span><span class="va">propagule_ma</span> <span class="op">&lt;-</span> <span class="va">pot_disp_pp</span><span class="op">[[</span><span class="st">'ma'</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">perma</span><span class="op">)</span> <span class="op">*</span> <span class="va">piMammal</span></span>
<span></span>
<span><span class="va">propagule</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">propagule_sb</span>,</span>
<span>                       <span class="va">propagule_mb</span>,</span>
<span>                       <span class="va">propagule_ma</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_propagule.html">plot_propagule</a></span><span class="op">(</span><span class="va">propagule</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotpropagule"></span>
<img src="detailed-manual_files/figure-html/plotpropagule-1.png" alt="Potential entry of propagules (propagules by year) into the pine-plantation."><p class="caption">
Figure 19: Potential entry of propagules (propagules by year) into the pine-plantation.
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation-and-computation-of-the-final-richness">Simulation and computation of the final richness<a class="anchor" aria-label="anchor" href="#simulation-and-computation-of-the-final-richness"></a>
</h2>
<p>Finally, the user can select the length of the simulation (number of years), and
diveRpine estimates the quantity of propagules input into each pixel of the pine plantation.
Then, the app calculates the final richness by considering the initial richness
values, the propagule input, and assuming the existence of plant establishment
constraints for this mountain area <span class="citation">(Mendoza et al. 2009, Matías et al. 2010, 2011, Quero et al. 2011)</span>. diveRpine generates a map (Figure <a href="#fig:riquezafinal">20</a>) with the end richness and the average values for the entire target pine plantation are shown.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co">## Compute the input over time</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">timeRange</span> <span class="op">&lt;-</span> <span class="fl">30</span> </span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="va">propagule</span><span class="op">*</span><span class="va">input</span><span class="op">$</span><span class="va">timeRange</span></span>
<span></span>
<span><span class="va">rich_pp_end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">rich_pp</span>, <span class="va">sim</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="va">rich_end</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">landscape</span>, <span class="va">rasterRich</span>, <span class="va">rich_pp_end</span><span class="op">)</span>,</span>
<span>                 fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">pp_value</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_richness.html">plot_richness</a></span><span class="op">(</span><span class="va">rich_end</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:riquezafinal"></span>
<img src="detailed-manual_files/figure-html/riquezafinal-1.png" alt="Final Richness"><p class="caption">
Figure 20: Final Richness
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Gomez2003SpatialPatterns" class="csl-entry">
Gómez, J. M. 2003. <a href="https://doi.org/10.1034/j.1600-0587.2003.03586.x" class="external-link">Spatial patterns in long-distance dispersal of <span>Quercus</span> ilex acorns by jays in a heterogeneous landscape</a>. Ecography 26:573–584.
</div>
<div id="ref-GomezAparicioetal2009ArePine" class="csl-entry">
Gómez-Aparicio, L., M. A. Zavala, F. J. Bonet, and R. Zamora. 2009. <a href="https://doi.org/10.1890/08-1656.1" class="external-link">Are pine plantations valid tools for restoring <span>Mediterranean</span> forests? <span>An</span> assessment along abiotic and biotic gradients</a>. Ecological Applications 19:2124–2141.
</div>
<div id="ref-GonzalezMorenoetal2011SpatialStructure" class="csl-entry">
González-Moreno, P., J. L. Quero, L. Poorter, F. J. Bonet, and R. Zamora. 2011. <a href="https://doi.org/10.1016/j.baae.2011.02.012" class="external-link">Is spatial structure the key to promote plant diversity in <span>Mediterranean</span> forest plantations?</a> Basic and Applied Ecology 12:251–259.
</div>
<div id="ref-Hewitt2002" class="csl-entry">
Hewitt, N., and M. Kellman. 2002. <a href="https://doi.org/10.1046/j.1365-2699.2002.00679.x" class="external-link">Tree seed dispersal among forest fragments: II. Dispersal abilities and biogeographical controls</a>. Journal of Biogeography 29:351–363.
</div>
<div id="ref-Jordanoetal2007DifferentialContribution" class="csl-entry">
Jordano, P., C. García, J. A. Godoy, and J. L. García-Castaño. 2007. <a href="https://doi.org/10.1073/pnas.0606793104" class="external-link">Differential contribution of frugivores to complex seed dispersal patterns</a>. Proceedings of the National Academy of Sciences 104:3278–3282.
</div>
<div id="ref-Matiasetal2011RepercussionsSimulated" class="csl-entry">
Matías, L., R. Zamora, and J. Castro. 2011. <a href="https://doi.org/10.1007/s10021-011-9437-7" class="external-link">Repercussions of <span>Simulated Climate Change</span> on the <span>Diversity</span> of <span>Woody-Recruit Bank</span> in a <span class="nocase">Mediterranean-type Ecosystem</span></a>. Ecosystems 14:672–682.
</div>
<div id="ref-Matiasetal2010SeedDispersal" class="csl-entry">
Matías, L., R. Zamora, I. Mendoza, and J. A. Hódar. 2010. <a href="https://doi.org/10.1111/j.1526-100X.2008.00475.x" class="external-link">Seed dispersal patterns by large frugivorous mammals in a degraded mosaic landscape</a>. Restoration Ecology 18:619–627.
</div>
<div id="ref-Mendozaetal2009RecruitmentLimitation" class="csl-entry">
Mendoza, I., L. Gómez-Aparicio, R. Zamora, and L. Matías. 2009. <a href="https://doi.org/10.1111/j.1654-1103.2009.05705.x" class="external-link">Recruitment limitation of forest communities in a degraded <span>Mediterranean</span> landscape: <span>Recruitment</span> limitation of forest communities</a>. Journal of Vegetation Science 20:367–376.
</div>
<div id="ref-Nathan2012" class="csl-entry">
Nathan, R., E. Klein, J. J. Robledo-Arnuncio, and E. Revilla. 2012. <span class="nocase">Dispersal kernels: review</span>. Pages 187–209 <span class="nocase">Dispersal Ecology and Evolution</span>. Oxford University Press.
</div>
<div id="ref-NavarroGonzalezetal2013WeightLanduse" class="csl-entry">
Navarro-González, I., A. J. Pérez-Luque, F. J. Bonet, and R. Zamora. 2013. <a href="https://doi.org/10.1890/12-0459.1" class="external-link">The weight of the past: Land-use legacies and recolonization of pine plantations by oak trees</a>. Ecological Applications 23:1267–1276.
</div>
<div id="ref-PerezLuqueetal2014SinfonevadaDataset" class="csl-entry">
Pérez-Luque, A. J., F. J. Bonet, R. Pérez-Pérez, R. Aspizua, J. Lorite, and R. Zamora. 2014. <a href="https://doi.org/10.3897/phytokeys.35.6363" class="external-link">Sinfonevada: <span>Dataset</span> of floristic diversity in <span>Sierra Nevada</span> forests (<span>SE Spain</span>)</a>. PhytoKeys 35:1–15.
</div>
<div id="ref-PonsPausas2007AcornDispersal" class="csl-entry">
Pons, J., and J. G. Pausas. 2007. <a href="https://doi.org/10.1007/s00442-007-0788-x" class="external-link">Acorn dispersal estimated by radio-tracking</a>. Oecologia 153:903–911.
</div>
<div id="ref-Queroetal2011LinkingStochasticity" class="csl-entry">
Quero, J. L., A. Herrero, and R. Zamora. 2011. <a href="https://doi.org/10.1016/j.baae.2010.11.007" class="external-link">Linking stochasticity to determinism of woody plant recruitment in a mosaic landscape: <span>A</span> spatially explicit approach</a>. Basic and Applied Ecology 12:161–171.
</div>
<div id="ref-Zamoraetal2010PositiveAdjacency" class="csl-entry">
Zamora, R., J. A. Hódar, L. Matías, and I. Mendoza. 2010. <a href="https://doi.org/10.1890/09-0055.1" class="external-link">Positive adjacency effects mediated by seed disperser birds in pine plantations</a>. Ecological Applications 20:1053–1060.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Antonio J. Pérez-Luque.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
